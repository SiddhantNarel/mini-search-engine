{% extends "base.html" %}

{% block title %}Crawl ‚Äî MiniSearch{% endblock %}

{% block content %}
<div class="crawl-page">
  <h2>Start a New Crawl</h2>
  <p class="crawl-description">
    Enter a seed URL and the crawler will visit that page, follow its links
    up to the specified depth, and build a fresh search index from everything
    it finds.
  </p>

  <!-- Success / error messages -->
  {% if message %}
    <div class="alert alert-success">{{ message }}</div>
  {% endif %}
  {% if error %}
    <div class="alert alert-error">{{ error }}</div>
  {% endif %}
  {% if crawl_in_progress %}
    <div class="alert alert-info">‚è≥ A crawl is currently running in the background‚Ä¶</div>
  {% endif %}

  <!-- Crawl form -->
  <form class="crawl-form" method="post" action="{{ url_for('crawl') }}">
    <div class="form-group">
      <label for="seed_url">Seed URL</label>
      <input
        type="url"
        id="seed_url"
        name="seed_url"
        class="form-input"
        placeholder="https://example.com"
        required
      />
      <small class="form-hint">The crawler will stay within this domain.</small>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="max_depth">Max Depth</label>
        <input
          type="number"
          id="max_depth"
          name="max_depth"
          class="form-input"
          value="{{ default_max_depth }}"
          min="0"
          max="5"
        />
        <small class="form-hint">How many link-hops from the seed (0‚Äì5).</small>
      </div>

      <div class="form-group">
        <label for="max_pages">Max Pages</label>
        <input
          type="number"
          id="max_pages"
          name="max_pages"
          class="form-input"
          value="{{ default_max_pages }}"
          min="1"
          max="500"
        />
        <small class="form-hint">Hard limit on pages to crawl.</small>
      </div>
    </div>

    <button type="submit" class="btn-primary" {% if crawl_in_progress %}disabled{% endif %}>
      üï∑ Start Crawl
    </button>
  </form>

  <!-- Help box -->
  <div class="crawl-tips">
    <h3>Tips</h3>
    <ul>
      <li>Crawling runs in the background ‚Äî you can search while it runs.</li>
      <li>A depth of 2 and 50 pages is a good starting point.</li>
      <li>The search index updates automatically once the crawl finishes.</li>
      <li>Respect the target site's <code>robots.txt</code> ‚Äî the crawler does this automatically.</li>
    </ul>
  </div>
</div>
{% endblock %}
